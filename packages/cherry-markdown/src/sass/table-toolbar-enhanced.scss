// 表格预览区工具栏增强样式
// 针对 cherry-table-container 和 cherry-highlight-line 的现代化样式优化

.cherry-table-container {
  position: relative;
  max-width: 100%;
  overflow-x: auto;
  border-radius: var(--radius-lg, 8px);
  box-shadow: var(--shadow-sm, 0 1px 3px rgba(0, 0, 0, 0.1));
  background: var(--base-bg, #fff);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  padding: 0;
  margin: 0;
  
  // 悬浮效果
  &:hover {
    box-shadow: var(--shadow-lg, 0 10px 25px rgba(0, 0, 0, 0.15));
    transform: translateY(-1px);
  }
  
  // 高亮行动画效果增强
  &.cherry-highlight-line {
    animation: modernHighlight 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 0 2px var(--primary-color, #3582fb), var(--shadow-lg, 0 10px 25px rgba(0, 0, 0, 0.15));
  }
  
  // 表格样式优化
  .cherry-table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    background: transparent;
    margin: 0;
    
    th, td {
      border: 1px solid var(--md-table-border, #e1e5e9);
      padding: 16px 20px;
      min-width: 120px;
      position: relative;
      transition: all 0.2s ease;
      vertical-align: middle;
      line-height: 1.6;
    }
    
    // 表头样式增强
    thead tr:first-child {
      th:first-child {
        border-top-left-radius: var(--radius-md, 6px);
      }
      th:last-child {
        border-top-right-radius: var(--radius-md, 6px);
      }
    }
    
    th {
      white-space: nowrap;
      background: linear-gradient(135deg, 
        var(--md-inline-code-bg, #f6f8fa) 0%, 
        color-mix(in srgb, var(--md-inline-code-bg, #f6f8fa) 95%, var(--primary-color, #3582fb) 5%) 100%);
      font-weight: 600;
      font-size: 14px;
      color: var(--base-font-color, #24292f);
      border-bottom: 2px solid var(--primary-color, #3582fb);
      height: 48px;
    }
    
    // 表格行样式
    tbody tr {
      transition: all 0.2s ease;
      
      &:hover {
        background: color-mix(in srgb, var(--primary-color, #3582fb) 5%, transparent);
        
        td {
          border-color: var(--primary-color, #3582fb);
        }
      }
      
      &:last-child {
        td {
          border-bottom: 1px solid var(--md-table-border, #e1e5e9);
          
          &:first-child {
            border-bottom-left-radius: var(--radius-md, 6px);
          }
          
          &:last-child {
            border-bottom-right-radius: var(--radius-md, 6px);
          }
        }
      }
    }
    
    // 表格数据单元格
    td {
      background: var(--base-bg, #fff);
      font-size: 13px;
      line-height: 1.8;
      
      // 数字单元格右对齐
      &[data-type="number"] {
        text-align: right;
        font-variant-numeric: tabular-nums;
      }
    }
  }

  // ECharts 工具栏样式增强
  .echarts-toolbox {
    .echarts-toolbox-feature {
      background: var(--toolbar-bg, #fff);
      border: 1px solid var(--toolbar-border, #e1e5e9);
      border-radius: var(--radius-sm, 4px);
      box-shadow: var(--shadow-sm, 0 1px 3px rgba(0, 0, 0, 0.1));
      transition: all 0.2s ease;
      
      &:hover {
        background: var(--toolbar-btn-hover-bg, #f6f8fa);
        border-color: var(--primary-color, #3582fb);
        box-shadow: var(--shadow-md, 0 4px 12px rgba(0, 0, 0, 0.15));
        transform: translateY(-1px);
      }
      
      &:active {
        transform: translateY(0);
        box-shadow: var(--shadow-sm, 0 1px 3px rgba(0, 0, 0, 0.1));
      }
    }
  }
}

// 现代化高亮动画
@keyframes modernHighlight {
  0% {
    background-color: transparent;
    box-shadow: 0 0 0 0 var(--primary-color, #3582fb);
  }
  50% {
    background-color: color-mix(in srgb, var(--primary-color, #3582fb) 10%, transparent);
    box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary-color, #3582fb) 20%, transparent);
  }
  100% {
    background-color: transparent;
    box-shadow: 0 0 0 2px var(--primary-color, #3582fb), var(--shadow-lg, 0 10px 25px rgba(0, 0, 0, 0.15));
  }
}

// 主题适配
.cherry {
  // 默认主题
  &.theme__default {
    .cherry-table-container {
      --table-primary-color: #0969da;
      --table-bg-hover: rgba(9, 105, 218, 0.05);
      --table-border-hover: #0969da;
    }
  }
  
  // 暗色主题
  &.theme__dark {
    .cherry-table-container {
      --table-primary-color: #58a6ff;
      --table-bg-hover: rgba(88, 166, 255, 0.1);
      --table-border-hover: #58a6ff;
      
      .cherry-table {
        th {
          background: linear-gradient(135deg, 
            var(--md-inline-code-bg, #21262d) 0%, 
            color-mix(in srgb, var(--md-inline-code-bg, #21262d) 95%, var(--table-primary-color) 5%) 100%);
          color: #f0f6fc !important; // 增强表头文字对比度
        }
        
        td {
          color: #e6edf3 !important; // 增强表格内容文字对比度
          background: var(--base-editor-bg, #0d1117) !important;
        }
        
        tbody tr:hover {
          background: var(--table-bg-hover);
          
          td {
            border-color: var(--table-border-hover);
            color: #ffffff !important; // 悬浮时进一步增强对比度
          }
        }
      }
    }
  }
  
  // 深海主题
  &.theme__abyss {
    .cherry-table-container {
      --table-primary-color: #8394AD;
      --table-bg-hover: rgba(131, 148, 173, 0.15);
      --table-border-hover: #8394AD;
      
      .cherry-table {
        th {
          background: linear-gradient(135deg, 
            var(--md-inline-code-bg, #00203d) 0%, 
            color-mix(in srgb, var(--md-inline-code-bg, #00203d) 95%, var(--table-primary-color) 5%) 100%);
          color: #FFFFFF !important; // 深海主题表头使用白色文字
          border-bottom-color: var(--table-primary-color);
        }
        
        td {
          color: #CECFCF !important; // 深海主题表格内容使用浅灰色文字
          background: var(--base-editor-bg, #1E222A) !important;
          border-color: var(--md-table-border, #8394AD);
        }
        
        tbody tr:hover {
          background: var(--table-bg-hover);
          
          td {
            border-color: var(--table-border-hover);
            color: #FFFFFF !important; // 悬浮时使用白色文字
          }
        }
      }
    }
  }
  
  // 绿色主题
  &.theme__green {
    .cherry-table-container {
      --table-primary-color: #2da44e;
      --table-bg-hover: rgba(45, 164, 78, 0.05);
      --table-border-hover: #2da44e;
    }
  }
  
  // 蓝色主题
  &.theme__blue {
    .cherry-table-container {
      --table-primary-color: #0969da;
      --table-bg-hover: rgba(9, 105, 218, 0.05);
      --table-border-hover: #0969da;
    }
  }
}

// 响应式设计
@media (max-width: 768px) {
  .cherry-table-container {
    border-radius: var(--radius-sm, 4px);
    
    .cherry-table {
      th, td {
        padding: 8px 12px;
        min-width: 80px;
        font-size: 12px;
      }
    }
  }
}

// 打印样式
@media print {
  .cherry-table-container {
    box-shadow: none;
    border: 1px solid #000;
    
    &:hover {
      transform: none;
      box-shadow: none;
    }
    
    .cherry-table {
      th, td {
        border-color: #000;
      }
    }
  }
}

// 高对比度模式支持
@media (prefers-contrast: high) {
  .cherry-table-container {
    .cherry-table {
      th, td {
        border-width: 2px;
      }
      
      th {
        font-weight: 700;
      }
    }
  }
}

// 减少动画模式支持
@media (prefers-reduced-motion: reduce) {
  .cherry-table-container {
    transition: none;
    
    &:hover {
      transform: none;
    }
    
    &.cherry-highlight-line {
      animation: none;
    }
    
    .cherry-table {
      th, td {
        transition: none;
      }
      
      tbody tr {
        transition: none;
      }
    }
  }
  
  @keyframes modernHighlight {
    0%, 100% {
      background-color: color-mix(in srgb, var(--primary-color, #3582fb) 10%, transparent);
    }
  }
}

// 表格编辑输入框样式优化
.cherry-previewer-table-content-handler__input {
  display: table-cell;
  vertical-align: middle;
  
  textarea {
    display: block;
    width: 100%;
    height: 100%;
    border: none;
    background: transparent;
    resize: none;
    outline: none;
    font-family: inherit;
    font-size: inherit;
    line-height: normal;
    vertical-align: middle;
    box-sizing: border-box;
    color: inherit;
    
    &:focus {
      outline: 2px solid var(--primary-color, #3582fb);
      outline-offset: -2px;
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary-color, #3582fb) 20%, transparent);
    }
  }
}

// 暗色和深海主题下的编辑输入框文字颜色
.cherry.theme__dark,
.cherry.theme__abyss {
  .cherry-previewer-table-content-handler__input {
    textarea {
      color: #ffffff !important;
      
      &::placeholder {
        color: rgba(255, 255, 255, 0.6) !important;
      }
    }
  }
}